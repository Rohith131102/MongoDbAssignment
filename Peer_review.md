## Peer review

### praneeth's  code review

Each block of code follows a similar structure, beginning by creating a reference to the relevant MongoDB collection using the `mydb` object. The `mongoimport_cmd` variable is then assigned an array of strings containing the command to be executed, including the `mongoimport` tool, the database and collection names, the file type (JSON), and the file path. The `subprocess.Popen()` method is then used to execute the command, passing in the `mongoimport_cmd` variable as an argument.He used mongoimport tool to import JSON data into MongoDB using Python


-  `question4_a_1`, *finds the top 10 commenters by name.* grouped  by name and created a count for each. It then creates a sorting variable that sorts the comments in descending order based on their count. Finally, it creates a limiting variable that limits the results to the top 10. The comments.aggregate() method is then used to execute the aggregation pipeline, passing in the grouping, sorting, and limiting variables as arguments. The results are then printed to the console.
- similarly for `question 4_a_2` . grouped by movie_id and create a count for each. It then creates a sorting variable that sorts the comments in descending order based on their count and limits by 10. The function then uses the movies.find_one() method to query the movies collection for the title of each movie based on its movie_id to *get the top 10 movies with the most comments*
- `question 4_a_3` ,used  $match stage to filter comments by the year entered, and grouped by month and counted the number of comments in each month, sorted in asc order to *get the total number of comments created each month in that year*
- `question 4_b_1 `,queried movies collection using the find() method, with the filter conditions that the imdb.rating field is not equal to an empty string and the `year` field is equal to the value of year_. The projection parameter is used to only return the title, imdb.rating and year fields. The query results are sorted in descending order by imdb.rating and limited to `n` documents to *get top `n` movies with the highest IMDB rating in a given year*
- `question 4_b_2`,find() method, with the filter conditions year field is equal to the value of year. The query results are sorted in descending order by imdb.rating and limited to `n` documents.
- `question 4_b_3`,used find with the filter conditions that  imdb.votes field is greater than 1000. The query results are sorted in descending order by imdb.rating and limited to `n` documents *to get top `n` movies with the highest IMDB rating, votes more than 1000*
- `question 4_b_4`,find() method, with the filter conditions that the tomatoes.viewer.rating field is not equal to an empty string and the title field matches the regular expression pattern specified by regex_ ,sorted in desc order and limited to n docs *to get title matching a given pattern sorted by highest tomatoes ratings*
- `question 4_b_5` used `$unwind` stage which splits the directors field into multiple documents, one for each director and  grouped by  directors and calculates the count of movies created by each director using the `$sum` operator, sorts them in desc and limits to n docs to get *top `n` directors who created the maximum number of movies*
- `question 4_b_6` ,`$match` with year and similar process as above to *get top `n` directors who created the maximum number of movies in a given year*
- `question 4_b_7` ,`$match` with genre, unwind by directors,groups by director and counts the no of movies ,sorts in desc and limits to n docs to get *top `n` directors who created the maximum number of movies in a given genre*
- `question 4_b_8` unwind, by cast ,groups by cast and counts the num of movies, sorts in desc and limits to n docs to get *top `n` actors who starred in the maximum number of movies*
- `question 4_b_9` ,match with year  and similar process as above to get *top `n` actors who starred in the maximum number of movies in a given year*
- `question 4_b_10` ,match with genre and similar process as above to get *top `n` actors who starred in the maximum number of movies in a given genre*
- `question 4_b_11` ,match with imdb rating ,unwind by genre ,sort by imdb in desc ,groups the movies by genre, and creates an array of the top `n` movie titles for each genre. Finally, it sorts the genres by `_id` to get *top `n` movies for each genre with the highest IMDB rating*
- `question 5_a` ,group the theatres by city and count the number of theatres in each city, sort the cities by count in descending order, and return only the top 10 cities with the most theatres to get *Top 10 cities with the maximum number of theatres*
- `question 5_b` ,creates a 2dsphere index on the `location.geo` field of the collection to enable the `$near` operator to efficiently find documents with geo-coordinates near the given longitude and latitude. It then queries the collection using `find()` and the `$near` operator to find the 10 documents nearest to the given coordinates, and then uses projection to include only the `theaterId` and `location.geo` fields in the result set to get *top 10 theatres nearby given coordinates*
